# APIé…ç½®æŒ‡å—

## æ¦‚è¿°

ç³»ç»Ÿç°åœ¨æ”¯æŒé€šè¿‡Webç•Œé¢ä¿å­˜å’Œç®¡ç†Deribit APIé…ç½®å’Œäº¤æ˜“å‚æ•°ã€‚é…ç½®ä¼šè‡ªåŠ¨ä¿å­˜åˆ°`.env`æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### 1. Deribit APIé…ç½®
- âœ… API Keyå’ŒSecretå®‰å…¨å­˜å‚¨
- âœ… æµ‹è¯•æ¨¡å¼/ç”Ÿäº§æ¨¡å¼åˆ‡æ¢
- âœ… é…ç½®çŠ¶æ€å®æ—¶æ˜¾ç¤º
- âœ… è‡ªåŠ¨ä¿å­˜åˆ°.envæ–‡ä»¶

### 2. äº¤æ˜“å‚æ•°é…ç½®
- âœ… æ— é£é™©åˆ©ç‡è®¾ç½®
- âœ… é»˜è®¤åˆå§‹èµ„é‡‘è®¾ç½®
- âœ… æ‰‹ç»­è´¹ç‡è®¾ç½®
- âœ… å‚æ•°éªŒè¯å’ŒèŒƒå›´æ£€æŸ¥

### 3. ç³»ç»Ÿä¿¡æ¯æ˜¾ç¤º
- âœ… ç‰ˆæœ¬ä¿¡æ¯
- âœ… APIçŠ¶æ€
- âœ… æ•°æ®åº“è¿æ¥çŠ¶æ€
- âœ… Deribité…ç½®çŠ¶æ€

## ä½¿ç”¨æ­¥éª¤

### æ­¥éª¤1: è·å–Deribit APIå¯†é’¥

1. è®¿é—® [Deribitå®˜ç½‘](https://www.deribit.com)
2. æ³¨å†Œè´¦å·å¹¶ç™»å½•
3. è¿›å…¥ **Account â†’ API** é¡µé¢
4. åˆ›å»ºæ–°çš„APIå¯†é’¥ï¼š
   - æµ‹è¯•ç¯å¢ƒ: https://test.deribit.com/account/BTC/api
   - ç”Ÿäº§ç¯å¢ƒ: https://www.deribit.com/account/BTC/api
5. è®¾ç½®æƒé™ï¼ˆå»ºè®®åªè¯»æƒé™ç”¨äºå›æµ‹ï¼‰ï¼š
   - âœ“ Read (è¯»å–å¸‚åœºæ•°æ®)
   - âœ— Trade (ä¸éœ€è¦äº¤æ˜“æƒé™)
   - âœ— Withdraw (ä¸éœ€è¦æç°æƒé™)

### æ­¥éª¤2: åœ¨ç³»ç»Ÿä¸­é…ç½®API

1. æ‰“å¼€å‰ç«¯ç•Œé¢: http://localhost:3000
2. ç‚¹å‡»é¡¶éƒ¨å¯¼èˆªæ çš„ **"è®¾ç½®"** Tab
3. åœ¨ **"Deribit APIé…ç½®"** åŒºåŸŸï¼š
   - å‹¾é€‰ **"æµ‹è¯•æ¨¡å¼"** (å»ºè®®å…ˆä½¿ç”¨æµ‹è¯•ç¯å¢ƒ)
   - è¾“å…¥ä½ çš„ **API Key**
   - è¾“å…¥ä½ çš„ **API Secret**
   - ç‚¹å‡» **"ä¿å­˜é…ç½®"** æŒ‰é’®
4. ç­‰å¾…æç¤º **"Deribité…ç½®ä¿å­˜æˆåŠŸ"**

### æ­¥éª¤3: é…ç½®äº¤æ˜“å‚æ•°

1. åœ¨ **"äº¤æ˜“å‚æ•°"** åŒºåŸŸï¼š
   - **æ— é£é™©åˆ©ç‡**: é»˜è®¤0.05 (5%)ï¼Œç”¨äºæœŸæƒå®šä»·
   - **é»˜è®¤åˆå§‹èµ„é‡‘**: é»˜è®¤$100,000ï¼Œç”¨äºå›æµ‹
   - **æ‰‹ç»­è´¹ç‡**: é»˜è®¤0.001 (0.1%)ï¼ŒDeribitå®é™…è´¹ç‡çº¦0.03%
2. æ ¹æ®éœ€è¦è°ƒæ•´å‚æ•°
3. ç‚¹å‡» **"ä¿å­˜å‚æ•°"** æŒ‰é’®

### æ­¥éª¤4: éªŒè¯é…ç½®

1. æŸ¥çœ‹ **"ç³»ç»Ÿä¿¡æ¯"** åŒºåŸŸ
2. ç¡®è®¤ï¼š
   - **APIçŠ¶æ€**: â— æ­£å¸¸
   - **æ•°æ®åº“**: â— sqlite (å·²è¿æ¥)
   - **Deribit**: â— æµ‹è¯•æ¨¡å¼ (å·²é…ç½®)

### æ­¥éª¤5: é‡å¯APIæœåŠ¡

é…ç½®ä¿å­˜åï¼Œéœ€è¦é‡å¯APIæœåŠ¡ä»¥åŠ è½½æ–°é…ç½®ï¼š

```bash
# åœæ­¢å½“å‰APIæœåŠ¡ (Ctrl+C)
# ç„¶åé‡æ–°å¯åŠ¨
cd BTCOptionsTrading/backend
python run_api.py
```

æˆ–è€…ä½¿ç”¨è¿›ç¨‹ç®¡ç†å·¥å…·é‡å¯ã€‚

## APIç«¯ç‚¹è¯´æ˜

### è·å–ç³»ç»Ÿä¿¡æ¯
```bash
GET /api/settings/system-info
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "version": "1.0.0",
  "environment": "development",
  "api_status": "online",
  "database_type": "sqlite",
  "database_status": "connected",
  "deribit_mode": "test",
  "deribit_status": "configured"
}
```

### è·å–Deribité…ç½®
```bash
GET /api/settings/deribit
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "api_key": "test_api...",
  "api_secret": "***",
  "test_mode": true,
  "has_credentials": true
}
```

### æ›´æ–°Deribité…ç½®
```bash
POST /api/settings/deribit
Content-Type: application/json

{
  "api_key": "your_api_key",
  "api_secret": "your_api_secret",
  "test_mode": true
}
```

### è·å–äº¤æ˜“é…ç½®
```bash
GET /api/settings/trading
```

å“åº”ç¤ºä¾‹ï¼š
```json
{
  "risk_free_rate": 0.05,
  "default_initial_capital": 100000.0,
  "commission_rate": 0.001
}
```

### æ›´æ–°äº¤æ˜“é…ç½®
```bash
POST /api/settings/trading
Content-Type: application/json

{
  "risk_free_rate": 0.06,
  "default_initial_capital": 150000.0,
  "commission_rate": 0.0005
}
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. APIå¯†é’¥å®‰å…¨
- âœ… APIå¯†é’¥å­˜å‚¨åœ¨`.env`æ–‡ä»¶ä¸­ï¼Œä¸ä¼šæäº¤åˆ°Git
- âœ… å‰ç«¯ç•Œé¢ä¸ä¼šæ˜¾ç¤ºå®Œæ•´çš„API Secret
- âœ… å»ºè®®ä½¿ç”¨åªè¯»æƒé™çš„APIå¯†é’¥
- âš ï¸ ä¸è¦åœ¨å…¬å…±åœºåˆåˆ†äº«ä½ çš„APIå¯†é’¥

### 2. æµ‹è¯•vsç”Ÿäº§ç¯å¢ƒ
- ğŸ§ª **æµ‹è¯•ç¯å¢ƒ** (test.deribit.com):
  - ä½¿ç”¨è™šæ‹Ÿèµ„é‡‘
  - é€‚åˆå¼€å‘å’Œæµ‹è¯•
  - æ•°æ®å¯èƒ½ä¸å®Œå…¨çœŸå®
  
- ğŸ­ **ç”Ÿäº§ç¯å¢ƒ** (www.deribit.com):
  - ä½¿ç”¨çœŸå®èµ„é‡‘
  - ä»…ç”¨äºå®ç›˜äº¤æ˜“
  - âš ï¸ è°¨æ…ä½¿ç”¨ï¼Œç¡®ä¿å……åˆ†æµ‹è¯•

### 3. æƒé™è®¾ç½®
å»ºè®®çš„APIæƒé™é…ç½®ï¼š
- âœ“ **Read**: è¯»å–å¸‚åœºæ•°æ®ã€è´¦æˆ·ä¿¡æ¯
- âœ— **Trade**: ä¸éœ€è¦ï¼ˆç³»ç»Ÿä»…ç”¨äºå›æµ‹ï¼‰
- âœ— **Withdraw**: ç»å¯¹ä¸è¦å¼€å¯

## é…ç½®æ–‡ä»¶ä½ç½®

- **åç«¯é…ç½®**: `BTCOptionsTrading/backend/.env`
- **å‰ç«¯é…ç½®**: `BTCOptionsTrading/frontend/.env`
- **é…ç½®ç¤ºä¾‹**: `BTCOptionsTrading/backend/.env.example`

## æ•…éšœæ’é™¤

### é—®é¢˜1: ä¿å­˜é…ç½®åæ²¡æœ‰ç”Ÿæ•ˆ
**è§£å†³æ–¹æ¡ˆ**: é‡å¯APIæœåŠ¡å™¨
```bash
cd BTCOptionsTrading/backend
# åœæ­¢å½“å‰æœåŠ¡ (Ctrl+C)
python run_api.py
```

### é—®é¢˜2: APIè¿æ¥å¤±è´¥
**æ£€æŸ¥é¡¹**:
1. API Keyå’ŒSecretæ˜¯å¦æ­£ç¡®
2. æ˜¯å¦é€‰æ‹©äº†æ­£ç¡®çš„ç¯å¢ƒï¼ˆæµ‹è¯•/ç”Ÿäº§ï¼‰
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. DeribitæœåŠ¡æ˜¯å¦å¯ç”¨

### é—®é¢˜3: é…ç½®æ— æ³•ä¿å­˜
**æ£€æŸ¥é¡¹**:
1. `.env`æ–‡ä»¶æ˜¯å¦æœ‰å†™å…¥æƒé™
2. APIæœåŠ¡å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

## æµ‹è¯•é…ç½®

ä½¿ç”¨æµ‹è¯•è„šæœ¬éªŒè¯é…ç½®ï¼š

```bash
cd BTCOptionsTrading/backend
python test_settings_api.py
```

é¢„æœŸè¾“å‡ºï¼š
```
Total: 5/5 tests passed
```

## ä¸‹ä¸€æ­¥

é…ç½®å®Œæˆåï¼Œä½ å¯ä»¥ï¼š

1. **è·å–çœŸå®å¸‚åœºæ•°æ®**: ä½¿ç”¨é…ç½®çš„APIä»Deribitè·å–æœŸæƒé“¾æ•°æ®
2. **è¿è¡Œå›æµ‹**: ä½¿ç”¨å†å²æ•°æ®æµ‹è¯•äº¤æ˜“ç­–ç•¥
3. **åˆ†ææ³¢åŠ¨ç‡**: æŸ¥çœ‹å®æ—¶çš„éšå«æ³¢åŠ¨ç‡æ›²é¢
4. **é£é™©ç®¡ç†**: è®¡ç®—ç»„åˆçš„å¸Œè…Šå­—æ¯å’ŒVaR

## ç›¸å…³æ–‡æ¡£

- [Deribit APIæ–‡æ¡£](https://docs.deribit.com/)
- [ç³»ç»Ÿä½¿ç”¨æŒ‡å—](./README.md)
- [APIæ¥å£æ–‡æ¡£](./API_README.md)
- [å›æµ‹æŒ‡å—](./BACKTEST_GUIDE.md)
